name = "synthetix-main"
description = "Core synthetix system"

# `salt` here only affects proxy contract
[setting.salt]
description = "Change this to a unique string when deploying multiple instances of the system. Note that only the proxy contract will be unique."
defaultValue = "main"

[setting.owner]
description = "Admin user for the system"
defaultValue = "0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266"

[setting.snx_mint]
description = "Amount of SNX to mint to the owner account"
defaultValue = "10000000000000000000000"

[run.deploy]
exec = "scripts/deploy.js"
func = "deploy"
args = []
modified = ["contracts", "scripts"]

[invoke.init_account]
target = ["Proxy"]
fromCall.func = "owner"
func = "initializeAccountModule"
factory.Account.event = "AccountCreated"
factory.Account.arg = 0
factory.Account.artifact = "AccountToken"
depends = ["run.deploy"]

[invoke.init_snxusd]
target = ["Proxy"]
fromCall.func = "owner"
func = "initializeSUSDTokenModule"
depends = ["run.deploy"]

# Set ownership
[invoke.nominate_owner]
target = ["Proxy"]
func = "nominateNewOwner"
args = ["<%= settings.owner %>"]
depends = ["invoke.init_account"]

[invoke.accept_owner]
from = "<%= settings.owner %>"
target = ["Proxy"]
func = "acceptOwnership"
depends = ["invoke.nominate_owner"]