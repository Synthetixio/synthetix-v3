name = "spot-market"
version = "<%= package.version %>"
description = "Spot market implementation"

[setting.marketOwner]
description = "spot market and fixed fee manager owner"
defaultValue = "0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266"

[import.synthetix]
source = "synthetix-main:1.0.0"

[run.deploy_spot_market]
exec = "scripts/deploy.js"
func = "deploy"
args = ["SpotMarket", ".*"]
modified = ["contracts", "scripts"]

[contract.SpotProxy]
artifact = "Proxy"
args = ["<%= contracts.SpotMarketRouter.address %>"]
abi = "SpotMarketRouter"
depends = ["run.deploy_spot_market"]

[invoke.acquire_ownership]
target = ["SpotProxy"]
from = "<%= settings.marketOwner %>"
func = "initializeOwnerModule"
args = ["<%= settings.marketOwner %>"]
depends = ["contract.SpotProxy"]

[invoke.set_systems]
target = ["SpotProxy"]
from = "<%= settings.marketOwner %>"
func = "setExternalSystems"
args = [
  "<%= imports.synthetix.contracts.CoreProxy.address %>",
  "<%= imports.synthetix.contracts.USDProxy.address %>"
]
depends = ["import.synthetix", "invoke.acquire_ownership"]
